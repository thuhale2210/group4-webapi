@model IEnumerable<MegaMartClient.Models.Dto.PurchaseOrderReadDto>

@{
    ViewData["Title"] = "Purchase Orders";
}

<div class="container mt-4">
    <h1 class="mb-3">Purchase Orders</h1>

    <div class="mb-3">
        <a asp-controller="PurchaseOrders"
           asp-action="Create"
           class="btn btn-primary">
            Create New Purchase Order
        </a>
    </div>

    <p class="text-muted">
        This page is currently using <strong>mock purchase order data</strong> for UI/demo only.
    </p>

    <table class="table table-striped table-hover mt-3">
        <thead class="table-light">
            <tr>
                <th>Id</th>
                <th>Created At</th>
                <th>Status</th>
                <th>Product</th>
                <th>Quantity</th>
                <th>Supplier</th>
                <th style="width: 220px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var po in Model)
            {
                var statusClass = po.Status switch
                {
                    "Pending" => "badge bg-warning text-dark",
                    "Confirmed" => "badge bg-info text-dark",
                    "Received" => "badge bg-success",
                    "Cancelled" => "badge bg-danger",
                    _ => "badge bg-secondary"
                };

                <tr>
                    <td>@po.Id</td>
                    <td>@po.CreatedAt.ToString("yyyy-MM-dd HH:mm")</td>
                    <td><span class="@statusClass">@po.Status</span></td>
                    <td>
                        @(
                            ViewBag.ProductNames.ContainsKey(po.ProductId)
                            ? ViewBag.ProductNames[po.ProductId]
                            : $"Unknown (ID {po.ProductId})"
                        )
                    </td>
                    <td>@po.Quantity</td>
                    <td>
                        @(
                            ViewBag.SupplierNames.ContainsKey(po.SupplierId)
                            ? ViewBag.SupplierNames[po.SupplierId]
                            : $"Unknown (ID {po.SupplierId})"
                        )
                    </td>
                    <td>
                        <a asp-action="Details"
                           asp-route-id="@po.Id"
                           class="btn btn-sm btn-outline-primary">
                            Details
                        </a>
                        <a asp-action="Edit"
                           asp-route-id="@po.Id"
                           class="btn btn-sm btn-outline-secondary ms-1">
                            Edit
                        </a>
                        <a asp-action="Delete"
                           asp-route-id="@po.Id"
                           class="btn btn-sm btn-danger ms-1">
                            Delete
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
